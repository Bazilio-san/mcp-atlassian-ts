# 1. Задачи (Issues)
#| Метод    | URL                             | Описание                      |
#| -------- | ------------------------------- | ----------------------------- |
#| `GET`    | `/issue/{issueIdOrKey}`         | Получить полные данные задачи |
#| `POST`   | `/issue`                        | Создать новую задачу          |
#| `PUT`    | `/issue/{issueIdOrKey}`         | Изменить поля задачи          |
#| `DELETE` | `/issue/{issueIdOrKey}`         | Удалить задачу                |
#| `GET`    | `/search`                       | Поиск задач по JQL            |
#| `POST`   | `/issue/{issueIdOrKey}/comment` | Добавить комментарий          |
#| `GET`    | `/issue/{issueIdOrKey}/comment` | Получить список комментариев  |
#

### Получить полные данные задачи
GET {{baseUrl}}/rest/api/2/issue/AITECH-379
Content-Type: application/json
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


### Получить полные данные задачи
PUT {{baseUrl}}/rest/api/2/issue/AITECH-1
Content-Type: application/json
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

{
  "fields": {
    "summary": "Updated Test Issue - 2025-09-19T18-15",
    "description": "Updated description for API testing 2"
  }
}

### Add worklog
POST {{baseUrl}}/rest/api/2/issue/AITECH-1/worklog
Content-Type: application/json
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

{
  "timeSpent": "2m",
  "comment": "API test worklog entry",
  "started": "2025-09-19T15:00:00.000+0000"
}

### Узнать типы связей между задачами
GET {{baseUrl}}/rest/api/2/issueLinkType
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}
Content-Type: application/json


### Создать связь между задачами
POST https://jira-dev.finam.ru/rest/api/2/issueLink
Content-Type: application/json
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

{
  "type": {
    "name": "Clone"
  },
  "inwardIssue": {
    "key": "AITECH-1"
  },
  "outwardIssue": {
    "key": "AITECH-2"
  },
  "comment": {
    "body": "Link created for API testing"
  }
}



### Пример создания задачи:
POST {{baseUrl}}/rest/api/2/issue
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}
Content-Type: application/json

{
  "fields": {
    "project": {
      "key": "AITECH"
    },
    "summary": "TEST-AITECH-2",
    "issuetype": {
      "name": "Задача+"
    },
    "description": "Три девицы под окном\nПряли поздно вечерком",
    "assignee": {
      "name": "vvmakarov"
    },
    "labels": ["CS-BOT"],
    "priority": {
      "id": "10504"
    }
  }
}


### Создать вложение к задаче
POST https://jira-dev.finam.ru/rest/api/2/issue/AITECH-1/attachments
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}
X-Atlassian-Token: no-check
Content-Type: multipart/form-data; boundary=WebAppBoundary

--WebAppBoundary
Content-Disposition: form-data; name="comment"
Content-Type: text/plain

Test upload
--WebAppBoundary
Content-Disposition: form-data; name="file"; filename="test.txt"
Content-Type: text/plain

< ./test-attachment.txt
--WebAppBoundary--


###

# 2. Метаданные

#| Метод | URL                              | Описание                                                                         |
#| ----- | -------------------------------- | -------------------------------------------------------------------------------- |
#| `GET` | `/issue/createmeta`              | Метаданные для создания задач (список проектов, типов задач, обязательных полей) |
#| `GET` | `/issue/{issueIdOrKey}/editmeta` | Доступные поля для редактирования конкретной задачи                              |
#| `GET` | `/priority`                      | Список приоритетов                                                               |
#| `GET` | `/status`                        | Список всех статусов                                                             |

###
GET {{baseUrl}}/rest/api/2/issue/createmeta
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

###
GET {{baseUrl}}/rest/api/2/priority
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

###
GET {{baseUrl}}/rest/api/2/issue/AITECH-845/editmeta
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

###
GET {{baseUrl}}/rest/api/2/status
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

# 3. Проекты

#| Метод | URL                                  | Описание                         |
#| ----- | ------------------------------------ | -------------------------------- |
#| `GET` | `/project`                           | Все проекты                      |
#| `GET` | `/project/{projectIdOrKey}`          | Данные проекта                   |
#| `GET` | `/project/{projectIdOrKey}/statuses` | Статусы по типам задач в проекте |


###
GET {{baseUrl}}/rest/api/2/project
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


###
GET {{baseUrl}}/rest/api/2/project/AITECH
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


# 4. Переходы (Transitions)

#| Метод  | URL                                 | Описание                         |
#| ------ | ----------------------------------- | -------------------------------- |
#| `GET`  | `/issue/{issueIdOrKey}/transitions` | Возможные переходы задачи        |
#| `POST` | `/issue/{issueIdOrKey}/transitions` | Перевести задачу в другой статус |

### Пример перевода задачи в статус:
POST /rest/api/2/issue/TEST-1/transitions

{
  "transition": { "id": "31" }
}

###

#5. Пользователи

#| Метод  | URL                             | Описание                              |
#| ------ | ------------------------------- | ------------------------------------- |
#| `GET`  | `/user?username={name}`         | Найти пользователя по имени           |
#| `GET`  | `/user/search?username={query}` | Поиск пользователей                   |
#| `POST` | `/user`                         | Создать пользователя (если разрешено) |

###
GET {{baseUrl}}/rest/api/2/user?username=vvmakarov
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

###
GET {{baseUrl}}/rest/api/2/user/search?username=Макаров
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


#6. Рабочий лог (Worklog)
#| Метод  | URL                             | Описание            |
#| ------ | ------------------------------- | ------------------- |
#| `GET`  | `/issue/{issueIdOrKey}/worklog` | Все логи работы     |
#| `POST` | `/issue/{issueIdOrKey}/worklog` | Добавить лог работы |


#7. Вложения
#| Метод  | URL                                 | Описание                                             |
#| ------ | ----------------------------------- | ---------------------------------------------------- |
#| `POST` | `/issue/{issueIdOrKey}/attachments` | Загрузить файл (нужен `X-Atlassian-Token: no-check`) |
#| `GET`  | `/attachment/{id}`                  | Скачать вложение                                     |
#

# Дополнительные возможности
# Пагинация — параметры startAt и maxResults для /search и других списков.
# Expand — параметр expand для загрузки вложенных данных (renderedFields, transitions, changelog).
# JQL — мощный язык поиска задач.
# Пример поиска по JQL:

###
POST {{baseUrl}}/rest/api/2/search

{
  "jql": "project = TEST AND status = 'Open'",
  "maxResults": 50,
  "fields": ["summary", "status", "assignee"]
}



### АВТОЗАПОЛНЕНИЕ

### reporter
GET {{baseUrl}}/rest/api/latest/user/search?username=Макаро
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### labels
GET {{baseUrl}}/rest/api/1.0/labels/suggest?query=CS
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### issuelinks
GET {{baseUrl}}/rest/api/2/issue/picker?currentProjectId=&showSubTaskParent=true&showSubTasks=true&currentIssueKey=AITECH-845&query=CSB
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Наблюдатели
GET {{baseUrl}}/rest/api/1.0/users/picker?fieldName=customfield_26803&query=Макаро
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### assignee
GET {{baseUrl}}/rest/api/latest/user/assignable/search?issueKey=AITECH-845&username=Макаро
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


### assignee
GET {{baseUrl}}/rest/agile/1.0/board/
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


### assignee
GET {{baseUrl}}/rest/agile/1.0/board/968/sprint
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}


### assignee
GET {{baseUrl}}/rest/agile/1.0/board/820/sprint
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Kanban boards list
GET {{baseUrl}}/rest/agile/1.0/board?type=kanban
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board info (EDOX PROD ISSUES board - ID 820)
GET {{baseUrl}}/rest/agile/1.0/board/820
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board configuration (columns, ranking, estimation)
GET {{baseUrl}}/rest/agile/1.0/board/820/configuration
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board projects
GET {{baseUrl}}/rest/agile/1.0/board/820/project
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board issues with JQL and quick filter
GET {{baseUrl}}/rest/agile/1.0/board/820/issue?jql=project%20%3D%20AITECH%20AND%20status%20!%3D%20Done&maxResults=50&quickFilterId=1
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board epics
GET {{baseUrl}}/rest/agile/1.0/board/820/epic
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Issues of a specific epic on the board
GET {{baseUrl}}/rest/agile/1.0/board/820/epic/12345/issue
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board versions
GET {{baseUrl}}/rest/agile/1.0/board/820/version
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}

### Board properties (list)
GET {{baseUrl}}/rest/agile/1.0/board/820/properties
Authorization: Basic {{JIRA_USER}} {{JIRA_PASS}}
