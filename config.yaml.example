# ==================================================
# MCP Atlassian TS Server Configuration
# Primary configuration file - most settings should be here
# Use environment variables only for sensitive data (URLs, credentials)
# ==================================================

# --------------------------------------------------
# SERVER CONFIGURATION
# --------------------------------------------------
server:
  # HTTP server port (range: 1024-65535)
  port: 3000

  # Server bind address
  # '0.0.0.0' - Listen on all network interfaces
  # 'localhost' - Listen only on local interface
  host: '0.0.0.0'

  # Transport type for MCP communication
  # Options: stdio (for Claude Desktop), http (for testing), sse (experimental)
  transportType: http

  # Service mode - which service to run
  # Options: jira (JIRA-only), confluence (Confluence-only)
  # REQUIRED - no default value
  serviceMode: jira

  # Server authentication token for HTTP mode
  token: test_server_token

# --------------------------------------------------
# LOGGING CONFIGURATION
# --------------------------------------------------
logging:
  # Log level: debug, info, warn, error
  level: info

  # Pretty-print logs (true/false)
  # Set to true for readable logs in development
  pretty: true

# --------------------------------------------------
# RATE LIMITING
# --------------------------------------------------
rateLimit:
  # Rate limit window in milliseconds (default: 900000 = 15 minutes)
  windowMs: 900000

  # Maximum requests per window (default: 100)
  maxRequests: 100

# --------------------------------------------------
# CACHING
# --------------------------------------------------
cache:
  # Cache TTL in seconds (default: 300 = 5 minutes)
  # Reduces API calls by caching responses
  ttlSeconds: 300

  # Maximum number of cached items (default: 1000)
  maxItems: 1000

# --------------------------------------------------
# SSL/TLS CONFIGURATION
# --------------------------------------------------
tls:
  # Reject unauthorized SSL certificates (true/false)
  # Set to false for self-signed certificates (not recommended for production)
  rejectUnauthorized: true

# --------------------------------------------------
# JIRA CONFIGURATION
# --------------------------------------------------
jira:
  # JIRA instance URL - SET VIA ENVIRONMENT VARIABLE: JIRA_URL
  # Example: https://jira.company.com
  url: ${JIRA_URL}

  # Authentication configuration - SET VIA ENVIRONMENT VARIABLES
  # Choose ONE method:
  auth:
    # 1. Basic Auth: username + password/token
    basic:
      username: ${JIRA_USERNAME}
      password: ${JIRA_PASSWORD}  # API token recommended

    # 2. Personal Access Token
    # pat: ${JIRA_PAT}

    # 3. OAuth 2.0
    # oauth2:
    #   clientId: ${JIRA_OAUTH_CLIENT_ID}
    #   clientSecret: ${JIRA_OAUTH_CLIENT_SECRET}
    #   accessToken: ${JIRA_OAUTH_ACCESS_TOKEN}
    #   refreshToken: ${JIRA_OAUTH_REFRESH_TOKEN}
    #   redirectUri: ${JIRA_OAUTH_REDIRECT_URI}

  # Epic Link custom field ID (varies by JIRA instance)
  # To find: JIRA Settings → Issues → Custom Fields → Epic Link
  epicLinkFieldId: customfield_10014

  # Maximum results per JIRA API request (max: 100)
  maxResults: 50

  # Tool configuration
  usedInstruments:
    # Include ALL to enable all tools, or specify a list of tool names
    include: ALL
    # Exclude specific tools (optional)
    exclude: []

    # Example of selective inclusion:
    # include:
    #   - jira_get_issue
    #   - jira_search_issues
    #   - jira_create_issue
    #   - jira_update_issue
    # exclude: []
    # powerEndpoint:
    #   baseUrl: <power_base_url> # env: JIRA_POWER_BASE_URL
    #   auth:
    #     basic:
    #       username: <power_username> # env: JIRA_POWER_USER
    #       password: <power_password> # env: JIRA_POWER_PASS

# --------------------------------------------------
# CONFLUENCE CONFIGURATION
# --------------------------------------------------
confluence:
  # Confluence instance URL - SET VIA ENVIRONMENT VARIABLE: CONFLUENCE_URL
  # Example: https://wiki.company.com
  url: ${CONFLUENCE_URL}

  # Authentication configuration - SET VIA ENVIRONMENT VARIABLES
  # Choose ONE method:
  auth:
    # 1. Basic Auth: username + password/token
    basic:
      username: ${CONFLUENCE_USERNAME}
      password: ${CONFLUENCE_PASSWORD}  # API token recommended

    # 2. Personal Access Token
    # pat: ${CONFLUENCE_PAT}

    # 3. OAuth 2.0
    # oauth2:
    #   clientId: ${CONFLUENCE_OAUTH_CLIENT_ID}
    #   clientSecret: ${CONFLUENCE_OAUTH_CLIENT_SECRET}
    #   accessToken: ${CONFLUENCE_OAUTH_ACCESS_TOKEN}
    #   refreshToken: ${CONFLUENCE_OAUTH_REFRESH_TOKEN}
    #   redirectUri: ${CONFLUENCE_OAUTH_REDIRECT_URI}

  # Maximum results per Confluence API request (max: 100)
  maxResults: 50

  # Tool configuration
  usedInstruments:
    # Include ALL to enable all tools, or specify a list of tool names
    include: ALL
    # Exclude specific tools (optional)
    exclude: []

    # Example of selective inclusion:
    # include:
    #   - confluence_search
    #   - confluence_get_page
    #   - confluence_create_page
    # exclude: []

    # Example with exclusions:
    # include: ALL
    # exclude:
    #   - confluence_delete_page
    #   - confluence_update_page

# --------------------------------------------------
# ADVANCED CONFIGURATION
# --------------------------------------------------
#advanced:
#  # Debug mode (true/false) - enables verbose logging
#  debug: false
#
#  # Environment variable suffix for loading additional .env files
#  # Example: Set to "prod" to also load .env.prod
#  suffixEnv: ""
#
#  # Testing configuration
#  test:
#    addXHeader: "x-user:vpupkin"
#    jiraProject: "TEST"
#    issueKey: ""  # Will be TEST-1
#    secondIssueKey: ""
#    epicIssueKey: ""
#    issueTypeName: "Task"
#    username: "vpupkin"
#    returnJson: false

